<?xml version="1.0" encoding="UTF-8"?>
<UpdateRoot xmlns="N_DATA_MODEL_HLFT" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
			testId="TS_CPDLC-047-02"
			testTitle="CPDLC message timeout alert (CPDLC system status validation)"
			testObjective="This test verifies that SKYRADAR generates CPDLC timeout alerts only when CPDLC system status is OPERATIONAL.&#xa;
			Conditions for CPDLC timeout alert generation are:&#xa;
1) The CPDLC system status is equal to OPERATIONAL. &#xa;
2) The track has an active CPDLC connection with logon status set to CONNECTED and data authority is CURRENT. &#xa;
3) A CPDLC uplink message of type CLEARANCE or INSTRUCTION has been transmitted to the aircraft with message status equal to SENT. &#xa;
4) The elapsed time since message transmission exceeds the response timeout threshold (CPDLC_RESPONSE_TIMEOUT). &#xa;
5) No CPDLC downlink response (WILCO, UNABLE, STANDBY, or ROGER) has been received from the aircraft for the pending message. &#xa;
6) The message criticality level is set to HIGH or SAFETY_CRITICAL requiring mandatory acknowledgment. &#xa;
7) The flag CPDLC_VOICE_BACKUP_ENABLED is set to true and the controller position has active voice communication capability.&#xa;
- 1st step: CPDLC system status is STANDBY, even with timeout exceeded, no alert should be generated.&#xa;
- 2nd step: CPDLC system status transitions to OPERATIONAL, timeout alert should be generated.&#xa;
- 3rd step: CPDLC system status changes to DEGRADED, timeout alert should be cleared.&#xa;
&#xa;
Message sent at t=5000ms, checked at t=70000ms (elapsed=65s > 60s timeout). Connection=CONNECTED. Message type=CLEARANCE. Criticality=HIGH. Voice backup=true.&#xa;
All conditions are met except system status, which is tested through multiple transitions."
			requirement1="SKYRADAR-CPDLC-047" requirementCMATS1="SKYRADAR-CPDLC-047"
			historyDate1="15/09/2024"
			historyDate2="12/11/2024"
			historyEcrId1="CMATS_ISD91"
			historyEcrId2="FRSKYRADAR-8221"
			historyVersion1="4.2"
			actionComment="CPDLC system transitions through STANDBY, OPERATIONAL, and DEGRADED states. Message timeout exceeded."
			actionDescription="Track has pending CPDLC message that has exceeded timeout. CPDLC system status determines whether timeout alert is generated.">

	<FlightPlanUpdate recNum="1" time="1" callsign="SIA456" cfl="380" cflUnity="F" arrivalRwy="02C" arrivalAirport="VHHH" isControlled="true" flightRules="I"/>

	<IdentUpdate recNum="1" time="2" callsign="SIA456" couplingStatus="AUTO" fplNum="1" sysTrackNum="1"/>

	<CpdlcSystemUpdate time="3">
		<CpdlcStatus status="STANDBY" voiceBackupEnabled="true"/>
	</CpdlcSystemUpdate>

	<CpdlcConnectionUpdate time="4">
		<Connection trackNum="1" logonStatus="CONNECTED" dataAuthority="CURRENT" voiceFrequency="118.7" voiceCapability="ACTIVE"/>
	</CpdlcConnectionUpdate>

	<CpdlcMessageUpdate time="5000">
		<UplinkMessage trackNum="1" messageId="MSG_002" messageType="INSTRUCTION" messageContent="TURN LEFT HEADING 270" messageStatus="SENT" transmissionTime="5000" criticalityLevel="SAFETY_CRITICAL" responseTimeout="30000" responseReceived="false"/>
	</CpdlcMessageUpdate>

	<TrackUpdates time="5100">
		<TrackUpdate trackNumber="1" measFlightLevel="38000" measFlightLevelAge="0" posX="80" posY="60" cartSpeedX="180" cartSpeedY="-30" identStr="1" baroAltitude="38000" baroAltitudeQNHCor="0" rocRodRate="0" altitudeQuality="HIGH" flightPhase="CRUISE">
			<Mode3A value="1234"/>
			<FlightPlan callsign="SIA456" ifpsFlightId="1" airportArr="VHHH" flightCatFr1Fr2="0" runway="02C"/>
			<Ident sac="118" sic="220"/>
			<SysTrkAge ssrAge="0"/>
		</TrackUpdate>
	</TrackUpdates>

	<TestResult resultTimeInMilliSec="40000" resultDescription="No CPDLC timeout alert is generated because CPDLC system status is STANDBY (elapsed time 35s > 30s timeout, but system not OPERATIONAL)."
				nextActionComment="At time 45000ms, CPDLC system transitions to OPERATIONAL.&#xa;
				Elapsed time is now 40s, still exceeding the 30s timeout."
				nextActionDescription="CPDLC system becomes OPERATIONAL. With timeout already exceeded, alert should be generated.">
		<Alerts alertType="CPDLC_TIMEOUT" trackNum="1" alertGenerated="false"/>
	</TestResult>

	<CpdlcSystemUpdate time="45000">
		<CpdlcStatus status="OPERATIONAL" voiceBackupEnabled="true"/>
	</CpdlcSystemUpdate>

	<TrackUpdates time="45100">
		<TrackUpdate trackNumber="1" measFlightLevel="38000" measFlightLevelAge="0" posX="95" posY="55" cartSpeedX="180" cartSpeedY="-30" identStr="1" baroAltitude="38000" baroAltitudeQNHCor="0" rocRodRate="0" altitudeQuality="HIGH" flightPhase="CRUISE">
			<Mode3A value="1234"/>
			<FlightPlan callsign="SIA456" ifpsFlightId="1" airportArr="VHHH" flightCatFr1Fr2="0" runway="02C"/>
			<Ident sac="118" sic="220"/>
			<SysTrkAge ssrAge="0"/>
		</TrackUpdate>
	</TrackUpdates>

	<TestResult resultTimeInMilliSec="45500" resultDescription="CPDLC timeout alert is generated because CPDLC system status is OPERATIONAL and elapsed time (40s) exceeds timeout (30s)."
				nextActionComment="At time 55000ms, CPDLC system transitions to DEGRADED status.&#xa;
				Timeout still exceeded but system no longer OPERATIONAL."
				nextActionDescription="CPDLC system becomes DEGRADED. Timeout alert should be cleared.">
		<Alerts alertType="CPDLC_TIMEOUT" trackNum="1" alertGenerated="true">
			<CpdlcTimeoutAlert severity="CRITICAL" messageId="MSG_002" elapsedTime="40" timeout="30" voiceReversionTriggered="true"/>
		</Alerts>
	</TestResult>

	<CpdlcSystemUpdate time="55000">
		<CpdlcStatus status="DEGRADED" voiceBackupEnabled="true"/>
	</CpdlcSystemUpdate>

	<TrackUpdates time="55100">
		<TrackUpdate trackNumber="1" measFlightLevel="38000" measFlightLevelAge="0" posX="108" posY="51" cartSpeedX="180" cartSpeedY="-30" identStr="1" baroAltitude="38000" baroAltitudeQNHCor="0" rocRodRate="0" altitudeQuality="HIGH" flightPhase="CRUISE">
			<Mode3A value="1234"/>
			<FlightPlan callsign="SIA456" ifpsFlightId="1" airportArr="VHHH" flightCatFr1Fr2="0" runway="02C"/>
			<Ident sac="118" sic="220"/>
			<SysTrkAge ssrAge="0"/>
		</TrackUpdate>
	</TrackUpdates>

	<TestResult resultTimeInMilliSec="55500" resultDescription="No CPDLC timeout alert is generated because CPDLC system status is DEGRADED (not OPERATIONAL).">
		<Alerts alertType="CPDLC_TIMEOUT" trackNum="1" alertGenerated="false"/>
	</TestResult>
</UpdateRoot>
